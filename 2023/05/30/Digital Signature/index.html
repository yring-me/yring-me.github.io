

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://yring-me.oss-cn-beijing.aliyuncs.com/test/202305221933187.jpeg">
  <link rel="icon" href="https://yring-me.oss-cn-beijing.aliyuncs.com/test/202305221933187.jpeg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="yring">
  <meta name="keywords" content="">
  
    <meta name="description" content="急急急 期末预习急急急">
<meta property="og:type" content="article">
<meta property="og:title" content="第六章 数字签名">
<meta property="og:url" content="http://example.com/2023/05/30/Digital%20Signature/index.html">
<meta property="og:site_name" content="yring">
<meta property="og:description" content="急急急 期末预习急急急">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://www.nasachina.cn/wp-content/uploads/2023/05/SeaBlueSky_Horalek_960_annotated.jpg">
<meta property="article:published_time" content="2023-05-30T15:07:00.000Z">
<meta property="article:modified_time" content="2023-06-29T12:14:28.471Z">
<meta property="article:author" content="yring">
<meta property="article:tag" content="Crypto">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.nasachina.cn/wp-content/uploads/2023/05/SeaBlueSky_Horalek_960_annotated.jpg">
  
  
  
  <title>第六章 数字签名 - yring</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/cloudeGlass.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":50,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>yring</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://cdn.pixabay.com/photo/2016/05/24/16/48/mountains-1412683_1280.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="第六章 数字签名"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-05-30 23:07" pubdate>
          May 30, 2023 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.7k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          31 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">第六章 数字签名</h1>
            
              <p class="note note-info">
                
                  
                    Last updated on June 29, 2023 pm
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <p>急急急 期末预习急急急</p>
<span id="more"></span>

<h2 id="数字签名基本概念"><a href="#数字签名基本概念" class="headerlink" title="数字签名基本概念"></a>数字签名基本概念</h2><h3 id="数字签名概念"><a href="#数字签名概念" class="headerlink" title="数字签名概念"></a>数字签名概念</h3><ul>
<li><p>使用 <em>公钥</em> 加密技术实现，用于 <em>鉴别数字信息与签名者身份</em> 的方法</p>
</li>
<li><p>以 <em>电子方式</em> 存储签名信息，在 <em>数字文档</em> 上身份验证。 接收者和第三方能够 <em>验证</em> 文档 <em>来自</em> 签名者，并且文档签名后 <em>没有被修改</em>，</p>
</li>
</ul>
<p>签名者也 <em>不能否认</em> 对文档的签名</p>
<p>数字签名必须保障：</p>
<p>（1） 接收者能够 <em>核实</em> 发送者对文档的签名</p>
<p>（2） 发送者事后 <em>不能否认</em> 对文档的签名</p>
<p>（3） <em>不能伪造</em> 对文档的签名</p>
<h3 id="数字签名载体"><a href="#数字签名载体" class="headerlink" title="数字签名载体"></a>数字签名载体</h3><ul>
<li>一个签名有 <em>消息</em> 和 <em>载体</em> 两个部分，即签名所表示的 <em>意义</em> 和签名的 <em>物理表现形式</em></li>
</ul>
<h4 id="传统签名-VS-数字签名"><a href="#传统签名-VS-数字签名" class="headerlink" title="传统签名 VS 数字签名"></a>传统签名 VS 数字签名</h4><ul>
<li>传统签名中，签名与文件是一个 <em>物理整体</em><ul>
<li>具有 <em>共同</em> 的载体</li>
<li>物理上的 <em>不可分割</em> <em>不可复制</em> 的特性</li>
<li>签名与文件的 <em>不可分割</em> 和 <em>不能重复</em> 使用</li>
</ul>
</li>
<li>数字签名中，签名与文件是电子形式<ul>
<li><em>没有固定的物理载体</em> 即签名与文件的物理形式和消息已经分开</li>
<li>电子载体是可以 <em>任意分割</em> <em>复制</em> 的</li>
</ul>
</li>
<li>传统签名的验证是通过 <em>与存档手迹对照来确定真伪的</em> 是 <em>主观的、模糊的、容易伪造的</em> ，从而也是 <em>不安全的</em></li>
<li>数字签名则使用 <em>密码</em> ，通过 <em>公开算法可以检验的</em> ，是<em>客观的、精确的、在计算上的是安全的</em></li>
</ul>
<h4 id="传统签名基本特点："><a href="#传统签名基本特点：" class="headerlink" title="传统签名基本特点："></a>传统签名基本特点：</h4><ul>
<li>能与被签文件在物理上 <em>不可分割</em></li>
<li>签名者 <em>不能否认</em> 自己的签名</li>
<li>签名 <em>能被伪造</em></li>
<li><em>容易</em> 被验证</li>
</ul>
<h4 id="数字签名是传统签名的数字化，要求："><a href="#数字签名是传统签名的数字化，要求：" class="headerlink" title="数字签名是传统签名的数字化，要求："></a>数字签名是传统签名的数字化，要求：</h4><ul>
<li>能与所签文件 <em>绑定</em></li>
<li>签名者 <em>不能否认</em> 自己的签名</li>
<li>签名 <em>不能被伪造</em></li>
<li>容易 <em>被自动</em> 验证</li>
</ul>
<h4 id="数字签名应具有的特性"><a href="#数字签名应具有的特性" class="headerlink" title="数字签名应具有的特性"></a>数字签名应具有的特性</h4><p>（1） 签名是可信的：任何人可验证前面的有效性</p>
<p>（2） 签名是不可伪造的：除合法签名者外，其他人伪造签名是困难的</p>
<p>（3） 签名是不可复制的： 一消息的签名不能复制为另一消息的签名</p>
<p>（4） 签名的消息是不可改变的：经签名的消息不能被篡改</p>
<p>（5） 签名是不可抵赖的： 签名者事后不能否认自己的签名</p>
<p><em>数字签名： 对身份认证，保持数据完整性，不可否认性</em></p>
<p><em>MAC： 可对身份认证，保持数据完整性，但不具有不可否认性</em></p>
<h2 id="数字签名的构成"><a href="#数字签名的构成" class="headerlink" title="数字签名的构成"></a>数字签名的构成</h2><h3 id="数字签名方案的构成"><a href="#数字签名方案的构成" class="headerlink" title="数字签名方案的构成"></a>数字签名方案的构成</h3><p>一个数字签名方案包括如下三个算法：</p>
<ul>
<li>密钥生成：产生用户的公私钥</li>
<li>签名算法：产生消息的签名</li>
<li>验证算法：验收消息的签名是否合法</li>
</ul>
<h2 id="数字签名的需求"><a href="#数字签名的需求" class="headerlink" title="数字签名的需求"></a>数字签名的需求</h2><h3 id="需满足条件"><a href="#需满足条件" class="headerlink" title="需满足条件"></a>需满足条件</h3><ul>
<li>必须相对容易生成该数字签名</li>
<li>必须相对容易识别和验证该数字签名</li>
<li><em>伪造</em> 该数字签名在 <em>计算上不可行</em> ，既包括对一个已有的数字签名构造新的消息，也包括对一个消息伪造一个数字签名</li>
</ul>
<h3 id="RSA签名算法"><a href="#RSA签名算法" class="headerlink" title="RSA签名算法"></a>RSA签名算法</h3><h4 id="RSA签名体制"><a href="#RSA签名体制" class="headerlink" title="RSA签名体制"></a>RSA签名体制</h4><ul>
<li>体制参数<ul>
<li>选两个保密的大素数 p 和 q，计算 $n &#x3D; p*q$ , $\varphi(n) &#x3D; (p-1)\cdot(q-1)$；</li>
<li>选一整数e，满足 $ 1&lt;e&lt;\varphi(n)$,且 $gcd(\varphi(n),e) &#x3D; 1$</li>
<li>计算 d，满足 $d \cdot e \equiv 1 \bmod \varphi(n)$;</li>
<li>以 $\lbrace e,n \rbrace$ 为公钥，$\lbrace d,n \rbrace$ 为私钥</li>
</ul>
</li>
</ul>
<h4 id="RSA公钥加密体制原理"><a href="#RSA公钥加密体制原理" class="headerlink" title="RSA公钥加密体制原理"></a>RSA公钥加密体制原理</h4><ul>
<li><p>密钥生成</p>
<ul>
<li>选择两个大素数 <em>p</em> 和 <em>q</em></li>
<li>计算 $ n &#x3D; p \cdot q , \varphi &#x3D; (p-1) \cdot (q-1)$</li>
<li>随机选取<em>e</em>，要求$ e &lt; n $，<em>e</em> 与 $ \varphi $ 没有公因数，即 <em>e</em> 与 $ \varphi $ 互质</li>
<li>选取 <em>d</em> 使得 $ ed  \equiv 1 \bmod \varphi(n) $</li>
<li>公钥是 $ (n,e) $，私钥是 $ (n,d) $</li>
</ul>
</li>
<li><p>签名</p>
<p>设消息为 $ m \in Z_n $，对其签名为 $$ S \equiv m^d \bmod n $$</p>
<p><em>S 即为签名</em></p>
</li>
<li><p>验证</p>
<p>接收方在收到消息 <em>m</em> 和签名 <em>s</em> 后，验证 $$ m \equiv s^e \bmod n $$ 是否成立，若成立，则发送方的签名有效</p>
</li>
<li><p>安全性： 大数分解的困难性</p>
<ul>
<li>如果RSA的模数 <em>n</em> 被成功分解为 $p*q$，则立即获得 $\varphi(n) &#x3D; (p-1) \cdot (q-1) $</li>
<li>从而能够确定 <em>e</em> 模 $ \varphi(n) $ 的乘法逆元 <em>d</em> ，</li>
<li>因此攻击成功</li>
</ul>
</li>
<li><p>正确性：</p>
<ul>
<li>因为 $ d \cdot e \equiv 1 \bmod \varphi (n) $</li>
<li>所以 $ s^e \equiv m^{d \cdot e} \equiv m^{1 + k \cdot \varphi (n)} \equiv m^1 \cdot m^{k \cdot \varphi (n)} \equiv m \bmod n $ </li>
<li>其中 k 为某个整数</li>
</ul>
</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><p>$$ m \equiv S^e \bmod n $$</p>
<p>（1） 对任意消息 $ y \in Z_n $ ,任何人可以计算 $ x \equiv y^e \bmod n $,因此任何人可以伪造对随机消息 <em>x</em> 的签名</p>
<p>（2） 如果消息 $x_1$ 和 $x_2$ 的签名分别是 $y_1$ 和 $ y_2$ ，则知道 $x_1,x_2,y_1,y_2$的人可以伪造消息 $x_1 \cdot x_2$的签名$y_1 \cdot y_2 $的签名 </p>
<p>（3） 在RSA签名方案中，需签名的消息 $ x \in Z_n $，所以每次只能对 $ \lfloor \log_2n \rfloor $位长消息签名，<em>签名速度慢</em></p>
<p><em>克服缺陷的方法：签名之前先求消息的Hash值</em></p>
<h3 id="EIGamal-签名算法"><a href="#EIGamal-签名算法" class="headerlink" title="EIGamal 签名算法"></a>EIGamal 签名算法</h3><ul>
<li>1985年 EIGamal 提出了一个基于离散对数问题的签名方案，后来称为 EIGamal 数字签名方案</li>
<li>1991年该数字签名方案的变形被美国国家标准局（NIST）确定位数字签名标准（DSS）</li>
</ul>
<h4 id="EIGamal签名体制"><a href="#EIGamal签名体制" class="headerlink" title="EIGamal签名体制"></a>EIGamal签名体制</h4><ul>
<li>体制参数<ul>
<li>p：大素数</li>
<li>g：$Z^*_p $的一个生成元</li>
<li>x：用户A的密钥，$x \in Z^*_p$</li>
<li>y：用户A的公钥，$y \equiv g^x(\bmod p)$</li>
<li>K:  随机数，用于计算 $r &#x3D; g^k \bmod p$, $r$ 是签名之一</li>
</ul>
</li>
<li>参数要求：<ul>
<li><em>P</em> 应为150位以上的十进制数，500位以上的二进制数，<em>p-1</em> 应有大素数因子</li>
<li><em>K</em> 必须是保密而且必须是一次性的<ul>
<li><em>K</em> 泄露，则敌手可以计算 $ y^K $从而可以计算出 <em>M</em></li>
<li>使用同一 <em>K</em> 加密不同的明文 <em>M</em> ，<em>M’</em> ，如果敌手知道 <em>M</em> 就可以由 $ C_2 &#x2F; C_2^{‘} &#x3D; M &#x2F; M^{‘}$求出<em>M‘</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="EIGamal公钥加密体制原理"><a href="#EIGamal公钥加密体制原理" class="headerlink" title="EIGamal公钥加密体制原理"></a>EIGamal公钥加密体制原理</h4><ul>
<li><p>密钥生成</p>
<ul>
<li>选取大素数 <em>p</em> ，$g \in Z^*_n $ 是一个生成元， <em>p</em> 和 <em>g</em> 公开</li>
<li>随机选整数 $ x, 1 \leq x \leq p-2 $,计算 $ y &#x3D; g^x \bmod p $</li>
<li>公钥为 <em>y</em> ，私钥为 <em>x</em></li>
</ul>
</li>
<li><p>签名</p>
<p>对于消息 <em>m</em> ，首先随机选取整数 <em>k</em> ，$ 1 \leq k \leq p-2 $,然后计算 </p>
<p>$$ r &#x3D; g^k \bmod p, s &#x3D; (h(m) -x \cdot r) \cdot k^{-1} \bmod (p-1) $$</p>
<p>则 <em>m</em> 的签名为 $(r,s)$,其中 <em>h</em> 为 <em>Hash</em>函数</p>
</li>
<li><p>验证</p>
<p>接收方在收到消息 <em>m</em>  和 签名 $(r,s)$ 后，验证</p>
<p>$$ y^r \cdot r^s &#x3D; g^{h(m)} \bmod p$$</p>
<p>如果等式成立 ，则 $(r,s)$ 是消息 <em>m</em> 的有效签名，反之无效</p>
</li>
<li><p>正确性</p>
<ul>
<li><p>因为 $ s &#x3D; (h(m) - x \cdot r) \cdot k^{-1} \bmod (p-1)$</p>
</li>
<li><p>所以 $ s \cdot k + x \cdot r &#x3D; h(m) \bmod (p-1)$</p>
</li>
<li><p>所以  $ g^{h(m)} &#x3D; g^{(s \cdot k + x \cdot r)} &#x3D; g^{sk} \cdot g^{xr} &#x3D; y^r \cdot r^s \bmod p$</p>
</li>
<li><p>note: $y &#x3D; g^x \bmod p$ ,  $r &#x3D; g^k \bmod p$</p>
<p>​		  如果消息 <em>m</em> 被篡改，则 <em>h(m)</em> 发生改变，从而 $y^r \cdot r^s \neq g^{h(m)} $ 起到验证作用</p>
</li>
</ul>
</li>
</ul>
<h4 id="讨论两问题"><a href="#讨论两问题" class="headerlink" title="讨论两问题"></a>讨论两问题</h4><p>  （1） 用EIGamal方案计算一个签名时，使用的随机数 <em>K</em> 能不能被泄露</p>
<p>  （2） 若Bob使用相同的 <em>K</em> 的值来签名不同的两份消息， Oscar能否攻破这个体制</p>
<p>Answer1:</p>
<ul>
<li>由于私钥 <em>x</em> 是保密的，所以如果攻击者想要得到这个密钥，必须求解离散对数问题 $\log_gy$ ,这是一个困难问题。但是随机数 <em>K</em> 泄露，则可解 $ x &#x3D; (h(m) - sk)r^{-1} \bmod (p-1)$ 得到 <em>x</em>，方案被攻破</li>
<li>note：为什么 <em>K</em> 泄露方案会被攻破呢<ul>
<li>先看看公开参数有什么 <ul>
<li>大素数 <em>P</em></li>
<li>生成元 <em>g</em></li>
<li>公钥 <em>y</em> ，<em>y</em> 由 $ y&#x3D; g^x \bmod p$ 得到</li>
<li>签名一 <em>r</em> ，<em>r</em> 由 $r&#x3D;g^k \bmod p$ 得到</li>
<li>签名二 <em>s</em> , <em>s</em> 由 $s &#x3D; (h(m) -x \cdot r) \cdot k^{-1} \bmod (p-1)$ 得到</li>
</ul>
</li>
<li>现在假设我们是中间人，我们可以获得这些消息，并想篡改消息 <em>m</em>，但是一旦篡改消息 <em>m</em>，会导致 <em>h(m)</em> 发生改变，从而导致 $$y^r \cdot r^s \neq g^{h(m)} $$ ，接收者就知道消息已被篡改。因此想要不被发现，必须连带着把 <em>r</em> ,<em>s</em> 也一起改变，即重新计算  $$s &#x3D; (h(m) -x \cdot r) \cdot k^{-1} \bmod (p-1) $$ ，得到 $s’$ ,并发送篡改后的签名 $(r,s’)$，这样接收方就无法判断消息是否被篡改</li>
<li>所以现在的问题是，如何计算 $s’$ ? 看看 <em>s</em> 的生成式，我们必须知道 <em>x</em> 和 <em>k</em> 才能计算 <em>s</em> </li>
<li>我们手上现在跟 <em>K</em> 相关的式子只有两条 $r&#x3D;g^k \bmod p$ 和 $s &#x3D; (h(m) -x \cdot r) \cdot k^{-1} \bmod (p-1)$ ，显然我们应该用前面那一条式子，因为后面的式子有两个未知数</li>
<li>那就来看看第一个式子吧， 我们现在知道 $r, g, p$，需要求 <em>g</em> 的几次方模 <em>p</em> 等于 <em>r</em> ，然而这是个很困难的问题，也就是离散对数问题，EIGamal的安全性就基于此。</li>
<li>一旦 <em>K</em> 泄露，就可以计算出 <em>x</em> ，整个消息就可以被篡改并进行重新签名得到 $s’$</li>
</ul>
</li>
</ul>
<p>Answer2:</p>
<ul>
<li><p>不可用同一个 <em>K</em> 做两次签名。若Bob利用相同 <em>K</em> 签名两次，即签名分别为 $(r,s_1)$ ,$(r,s_2)$ ,则Oscar可以联立方程 </p>
<p>$$<br>\begin{cases}<br>h(m1) &#x3D; xr +ks_1 \bmod (p-1) \newline h(m2) &#x3D; xr +ks_2 \bmod (p-1)<br>\end{cases}<br>$$</p>
<p>可得： $ x &#x3D; [h(m_1)s_2 - h(m_2)s_1] (s_2 - s_1) ^{-1} r^{-1} \bmod (p-1) $</p>
</li>
<li><p>note： 上式乘 $s_2$, 下式乘 $s_1$ 即可</p>
</li>
</ul>
<p>​			  </p>
<h3 id="DSS签名算法"><a href="#DSS签名算法" class="headerlink" title="DSS签名算法"></a>DSS签名算法</h3><p>数字签名标准DSS(Digital Signature Standard)是由美国NIST公布的联邦信息处理标准FIPS PUB 186，最初于1991年公布，在考虑了公众归队其安全性的反馈意见后，于1993年公布了其修改版</p>
<ul>
<li><p>DSS的基本方式</p>
<p>首先将DSS与RSA的签名方式做一比较。RSA算法既能用于加密和签名，又能用于密钥交换。与此不同，DSS使用的算法只能提供数字签名功能。下图是比较</p>
</li>
</ul>
<p><img src="https://yring-me.oss-cn-beijing.aliyuncs.com/test/202305311621956.png" srcset="/img/loading.gif" lazyload alt="1"></p>
<h4 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h4><ul>
<li><p>设 $512 \leq L \leq 1024$ 且 $L$ 是64的倍数，选取 $2^{L-1} &lt; p &lt;2^L$ 大素数，其满足存在160比特的素数$q|p-1$</p>
</li>
<li><p>随机选取整数 $h$ ,$ 1 &lt; h &lt;p-1 $ ,且使 $ g &#x3D; h^{(p-1) &#x2F;q} \bmod p $ , $p,g$ 公开 </p>
</li>
<li><p>随机选取整数 $x$ , $1 \leq x \leq q-1 $ , 计算 $ y &#x3D; g^x \bmod p $</p>
</li>
<li><p>公钥为 $y$, 私钥为 $x$</p>
</li>
</ul>
<h4 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h4><ul>
<li>对于消息 <em>m</em> ，首先随机选取一个整数 <em>k</em>，$1 \leq k \leq p-2 $ ,然后计算<br>$$ {left}<br>\begin{align}<br>&amp;r &#x3D; (g^k \bmod p ) \bmod q \<br>&amp;s &#x3D; (h(m) + xr) K^{-1} \bmod q<br>\end{align}<br>$$<br>则 <em>m</em> 的签名为 $(r,s$) ,其中 <em>h</em> 为Hash函数SHA</li>
</ul>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><ul>
<li><p>接收方收到消息 <em>m</em> 和 签名 $(r,s$)，后计算<br>$$<br>\begin{align}<br>u_1 &amp;&#x3D; h(m) s^{-1} \bmod q \newline<br>u_2 &amp;&#x3D; rs^{-1} \bmod q<br>\end{align}<br>$$</p>
</li>
<li><p>验证等式<br>$$<br>(g^{u_1}y^{u_2} \bmod p) \bmod q &#x3D;r<br>$$</p>
</li>
<li><p>如果等式成立，则$(r,s)$ 消息 <em>m</em> 的有效签名</p>
</li>
</ul>
<h4 id="正确性"><a href="#正确性" class="headerlink" title="正确性"></a>正确性</h4><ul>
<li><p>因为 $u_1 + xu_2 \bmod q &#x3D; (h(m) + xr)s^{-1} \bmod q &#x3D; k$</p>
</li>
<li><p>所以<br>$$<br>\begin{align}<br>g^{u_1}y^{u_2} \bmod p \bmod q &amp;&#x3D; g^{u_1+ xu_2} \bmod p \bmod q \newline<br>&amp;&#x3D; g^k \bmod p \bmod q \newline<br>&amp;&#x3D;r<br>\end{align}<br>$$</p>
</li>
</ul>
<h2 id="特殊性质的签名算法"><a href="#特殊性质的签名算法" class="headerlink" title="特殊性质的签名算法"></a>特殊性质的签名算法</h2><h3 id="盲签名"><a href="#盲签名" class="headerlink" title="盲签名"></a>盲签名</h3><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><ul>
<li>盲签名方案是在发送者 <em>A</em> 和发送者 <em>B</em> 之间的双方协议。其基本思想如下：<ul>
<li><em>A</em> 发送给 <em>B</em> 一段消息，<em>B</em> 对它签名并送回 <em>A</em> </li>
<li>从这个签名 <em>A</em> 能够计算 <em>B</em> 关于 <em>A</em> 预先所选消息 <em>m</em> 的签名</li>
<li>协议完成时 <em>B</em> 既不知道消息 <em>m</em> 也不知道消息的签名</li>
</ul>
</li>
<li>盲签名的目的是防止 <em>B</em> 看到消息和签名，从而使 <em>B</em> 以后不能将所签消息和发送者 <em>A</em> 联系起来</li>
</ul>
<h4 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h4><ul>
<li>发送者 <em>A</em>（客户）不希望签名者 <em>B</em>（银行）能够将一条先验消息 <em>m</em> 及其签名 $S_B(m)$ 与协议的特定实例相联系</li>
<li>这个特性在电子现金应用中可能很重要，因为那里的消息也许表示 <em>A</em> 所花的金钱数额</li>
<li>当 <em>m</em> 和 $S_B(m)$ 提交给 <em>B</em> 进行支付时， <em>B</em> 无法推断原先接收签名的是谁。这就是允许 <em>A</em> 的匿名性，从而 <em>A</em> 的消费模式不能被监测</li>
</ul>
<h4 id="所需组件"><a href="#所需组件" class="headerlink" title="所需组件"></a>所需组件</h4><ul>
<li>签名者 <em>B</em> 的一种数字签名机制，用 $S_B(x)$ 记 <em>B</em> 对 <em>x</em> 签名</li>
<li>函数 $f$ 和 $g$ （只有发送者知道），满足$g(S_B(f(m))) &#x3D; S_B(m)$ 。其中 $f$ 叫盲化函数，$g$ 叫去盲函数，$f(m)$ 叫做盲消息。此条对 $S_B$ 和 $g$ 的选择加了许多限制</li>
</ul>
<h4 id="Chaum-盲签名协议"><a href="#Chaum-盲签名协议" class="headerlink" title="Chaum 盲签名协议"></a>Chaum 盲签名协议</h4><ul>
<li>摘要：发送者 <em>A</em> 接收 <em>B</em> 关于盲消息的签名。由此 <em>A</em> 计算 <em>B</em> 关于 <em>A</em> 预先所选消息 <em>m</em> 的签名，$0 \leq m \leq n-1 $ 。<em>B</em> 既没有消息 <em>m</em> 也没有 <em>m</em> 相关签名的知识<ul>
<li><em>B</em> 的RSA公钥和私钥分别是 $(n,e)$ 和 $d$ 。<em>k</em> 是 <em>A</em> 随机选择秘密数，满足 $ 0 \leq k \leq n-1$ 且 $gcd(n,k) &#x3D;1 $ </li>
<li>协议步骤<ul>
<li>（盲化） <em>A</em> 计算 $m^* &#x3D; mk^e \bmod n$</li>
<li>（签名） <em>B</em> 计算 $s^* &#x3D; (m^*) ^d \bmod n $</li>
<li>（去盲） <em>A</em> 计算 $s&#x3D;k^{-1} s^* \bmod n$</li>
</ul>
</li>
</ul>
</li>
<li>正确性<ul>
<li>显然 <em>s</em> 是 <em>m</em> 的签名 ，即 $s&#x3D;m^d \bmod n$</li>
<li><em>B</em> 既没有消息 <em>m</em> 也没有 <em>m</em> 相关签名 <em>s</em> 的知识</li>
</ul>
</li>
</ul>
<h4 id="不可追踪电子现金"><a href="#不可追踪电子现金" class="headerlink" title="不可追踪电子现金"></a>不可追踪电子现金</h4><ul>
<li><p>Chaum, Fiat, 和Naor提出一个不可追踪电子现金方案。 </p>
<ul>
<li>加入者A获取来自银行的电子现金货币 – A可以将此货币在商店B花掉，而B无需与银行在线验证货币的真实性。 – 当B在银行将电子货币兑现时，银行不能将其与A联系起来。 </li>
<li>如果A企图以该货币花两次（重复消费），那么A的身份就会暴露。</li>
</ul>
</li>
<li><p>Okamoto提出一种可分电子现金方案。可分电子硬币是一个 与金钱数值关联的元素，可用来进行多次电子买卖，前提是 所有交易的金钱总额不超过硬币数额</p>
</li>
</ul>
<h3 id="不可否认签名"><a href="#不可否认签名" class="headerlink" title="不可否认签名"></a>不可否认签名</h3><h4 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h4><ul>
<li>不可否认的数字签名由 CHaum 和 van Antwerpen 在1989年提出</li>
<li>不可否认签名没有签名者的合作，接收者无法验证签名</li>
</ul>
<h4 id="应用-1"><a href="#应用-1" class="headerlink" title="应用"></a>应用</h4><ul>
<li>实体 <em>A</em>（客户）希望访问被实体 <em>B</em>（银行）控制的某个安全区域。比如该安全区域可能是存放保险箱的房间。在许可访问之前，<em>B</em> 要求 <em>A</em> 签署一份时间和日期的文件。如果 <em>A</em> 采用了不可否认签名，那么在验证过程中没有 <em>A</em> 的直接参与， （在以后的日期）<em>B</em> 就不能向任何人证明 <em>A</em> 使用过安全区域中的设施</li>
<li>假定某大公司 <em>A</em> 制作了一个软件包。<em>A</em> 对软件包签名并将它卖给实体 <em>B</em>，而 <em>B</em> 决定将其拷贝再卖给第三方<em>C</em>，那么没有 <em>A</em> 的合作 <em>C</em> 就无法验证该软件是否正版<ul>
<li>当然，这种措施并 <em>不能阻止</em> <em>B</em> 用它自己的签名重新签署软件包，但因此 <em>B</em> 也就 <em>无法利用</em> 与 <em>A</em> 名气相关的市场利益。而且 <em>追踪</em>  <em>B</em> 的欺诈行为也将很 <em>容易</em></li>
</ul>
</li>
</ul>
<h4 id="组成"><a href="#组成" class="headerlink" title="组成"></a>组成</h4><ul>
<li>一个不可否认签名方案有三部分组成：</li>
<li>签名算法</li>
<li>验证协议</li>
<li>否认协议</li>
</ul>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li>签名者可以声称一个签名是伪造的，在这种情况下，如果 <em>签名者拒绝</em> 参加验证，就可认为签名者有欺骗行为。如果签名者 <em>参加</em> 验证，由否认协议就可推断出签名的 <em>真伪</em> 。 </li>
<li>否认协议需要做到以下两点 </li>
<li>B能使A相信一个不合法的签名是伪造的。</li>
<li>B以很小的概率使A相信一个合法签名是伪造的</li>
<li>不可否认签名的一个 <em>不足之处</em> 是签名者有可能不在场或者拒绝合作，而导致签名无法被接收者验证。 <ul>
<li>Chaum提出“指定验证者签名”的概念，其中签名者指定某 实体作为签名的验证者。 </li>
<li>一旦签名者不在场或者拒绝合作，验证者就有权力与接收 者交互来检查签名。</li>
<li>验证者不能产生签名者的签名</li>
</ul>
</li>
</ul>
<h3 id="群签名"><a href="#群签名" class="headerlink" title="群签名"></a>群签名</h3><h4 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h4><ul>
<li>1991年，Chaum和Van Heijst提出群签名方案。 </li>
<li>该方案允许群众的某个成员以群的名义匿名地签发消息。满足下述三个条件：<ul>
<li><em>只有</em> 群中的成员才能代表群进行签名；</li>
<li>签名的接收者 <em>能验证</em> 签名是哪一个群的一个合法签名，但 <em>不能分辨</em> 具体的签名者。 </li>
<li>一旦出现争端，可借助群成员或一个可信的机构能 <em>识别出签名者</em></li>
</ul>
</li>
</ul>
<h4 id="应用-2"><a href="#应用-2" class="headerlink" title="应用"></a>应用</h4><ul>
<li>一个公司有几台计算机，每台都联在局域网上。公司的 <em>每个部门</em> 有其自己的打印机（也连在局域网上），并且 <em>只有本部门</em> 的人员才能允许使用其部门的打印机。因此，打印前必须 <em>确认</em> 用户在哪个部门工作。同时公司为了保密，<em>不可以暴露用户的身份</em>。然而，如果有人 <em>滥用</em> 打印机，主管者必须能 <em>找出</em> 是谁在滥用打印机</li>
</ul>
<h4 id="组成-1"><a href="#组成-1" class="headerlink" title="组成"></a>组成</h4><p>（1）建立（setup） 一个用以产生群公钥和私钥的多项式概率算法。</p>
<p>（2）加入（join） 一个用户和群管理员之间的交互式协议。执行该协议可以使用户成为群成员，群管理员得到群成员的秘密的成员管理密钥，并产生群成员的私钥和成员证书。 </p>
<p>（3）签名（sign） 一个概率算法，当输入一个消息、一个群成员 的私钥和一个群公钥后，输出对该消息的签名。 </p>
<p>（4）验证（verify） 给定一个消息的签名和一个群公钥后，判断该签名相对于该群公钥是否有效。 </p>
<p>（5）打开（open） 给定一个签名、群公钥和群私钥的条件下确定 签名者的身份</p>
<h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><p>① 正确性（correctness）</p>
<p>② 不可伪造性（unforgeability）  </p>
<p>③ 匿名性（anonymity）  </p>
<p>④ 不可关联性（unlinkability）  </p>
<p>⑤ 可跟踪性（traceability） </p>
<p>⑥ 可开脱性（exculpability）  </p>
<p>⑦ 抗联合攻击（coalition-resistance）</p>
<h3 id="代理签名"><a href="#代理签名" class="headerlink" title="代理签名"></a>代理签名</h3><p>&lt;TODO：概念&gt; (他PPT也妹给啊)</p>
<h4 id="组成-2"><a href="#组成-2" class="headerlink" title="组成"></a>组成</h4><ul>
<li>系统建立  选定代理签名方案的系统参数，用户的密钥等</li>
<li>签名权力的委托  原始签名者将自己的签名权力委托给代理签名 者</li>
<li>代理签名的产生  代理签名者代表原始签名者产生代理签名</li>
<li>代理签名的验证 验证人验证代理签名的有效性。</li>
</ul>
<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><p>根据签名权力委托的方式不同，代理签名可以分为以下几类： </p>
<p>（1）完全代理（full delegation）  </p>
<p>（2）部分代理（partial delegation） </p>
<p>（3）具有证书的代理（delegation by warrant） </p>
<p>（4）具有证书的部分代理（partial delegation with warrant）</p>
<p>根据原始签名者能否产生同代理签名者一样的签名，代理签名又 可分为两类： </p>
<p>（1）代理非保护（proxy-unprotected） 原始签名者能够产生有效的 代理签名。 </p>
<p>（2）代理保护（proxy-protected） 原始签名者不能够产生有效的代 理签名</p>
<h4 id="强代理方案满足性质："><a href="#强代理方案满足性质：" class="headerlink" title="强代理方案满足性质："></a>强代理方案满足性质：</h4><p>① 可区分性（distinguishability）</p>
<p>② 可验证性（verifiability） </p>
<p>③ 强不可伪造性（strong unforgeability）  </p>
<p>④ 强可识别性（strong identifiability）  </p>
<p>⑤ 强不可否认性（strong undeniability） ⑥ 防止滥用（prevention of misuse）</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/SYSU/" class="category-chain-item">SYSU</a>
  
  
    <span>></span>
    
  <a href="/categories/SYSU/Crypt/" class="category-chain-item">Crypt</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Crypto/">#Crypto</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>第六章 数字签名</div>
      <div>http://example.com/2023/05/30/Digital Signature/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>yring</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>May 30, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/06/01/cryptographic%20protocol/" title="第七章 密码协议">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">第七章 密码协议</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/05/30/WhiteHat%20CTF%202015%20Crypto400/" title="WhiteHat CTF 2015 Crypto400">
                        <span class="hidden-mobile">WhiteHat CTF 2015 Crypto400</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <i class="iconfont icon-love"></i>nobody knows ,but we always know

    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/yinghua.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicLine.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css.js"></script>
<script src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/boom.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/runtime.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/containsWord.min.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>

  <script async src="/js/fireworks.js"></script>
  
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
